<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="jp.co.interline.dao.BillMapper">
	<insert id="insertBillSheet1" parameterType="billSheet1DTO">
		insert into billSheet1 (
			documentNum,
			estimateNum,
			userNum,
			userName,
			userDepartment,
			userPosition,
			billDate,
			documentTypeNum,
			supplier,
			address,
			post,
			phoneNumber,
			representative,
			stamp,
			stampFileName,
			logoFileName,
			receiver,
			documentName,
			payCondition,
			deadline,
			bankName,
			branchName,
			accountName,
			hurigana,
			accountNumber,
			depositeClassification,
			note,
			sum,
			tax,
			sumWithTax,
			sumWithTax2,	
			state,
			comment,
			workflowNum,
			updateDate,
			updater
		) 
		values
		(
			#{documentNum},
			#{estimateNum},
			#{userNum},
			#{userName},
			#{userDepartment},
			#{userPosition},
			#{billDate},
			#{documentTypeNum},
			#{supplier},
			#{address},
			#{post},
			#{phoneNumber},
			#{representative},
			#{stamp},
			#{stampFileName},
			#{logoFileName},
			#{receiver},
			#{documentName},
			#{payCondition},
			#{deadline},
			#{bankName},
			#{branchName},
			#{accountName},
			#{hurigana},
			#{accountNumber},
			#{depositeClassification},
			#{note},
			#{sum},
			#{tax},
			#{sumWithTax},
			#{sumWithTax2},	
			#{state},
			#{comment},
			<choose>
				<when test="workflowNum == 0">
					null,
				</when>
				<when test="order != 0">
					#{workflowNum},
				</when>
			</choose>
			CURRENT_TIMESTAMP,
			#{updater}
		)
	</insert>
	<insert id="insertBillSheet1Items" parameterType="billSheet1ItemsRecieveDTO">
		insert into BillSheet1Items (
			documentNum,rowNum,item,itemName,amount,unit,unitPrice,price
		)
		values
		(#{documentNum},#{rowNum1},#{item1},#{itemName1},${amount1},#{unit1},${unitPrice1},${price1}),
		(#{documentNum},#{rowNum2},#{item2},#{itemName2},${amount2},#{unit2},${unitPrice2},${price2}),
		(#{documentNum},#{rowNum3},#{item3},#{itemName3},${amount3},#{unit3},${unitPrice3},${price3}),
		(#{documentNum},#{rowNum4},#{item4},#{itemName4},${amount4},#{unit4},${unitPrice4},${price4}),
		(#{documentNum},#{rowNum5},#{item5},#{itemName5},${amount5},#{unit5},${unitPrice5},${price5}),
		(#{documentNum},#{rowNum6},#{item6},#{itemName6},${amount6},#{unit6},${unitPrice6},${price6}),
		(#{documentNum},#{rowNum7},#{item7},#{itemName7},${amount7},#{unit7},${unitPrice7},${price7}),
		(#{documentNum},#{rowNum8},#{item8},#{itemName8},${amount8},#{unit8},${unitPrice8},${price8}),
		(#{documentNum},#{rowNum9},#{item9},#{itemName9},${amount9},#{unit9},${unitPrice9},${price9}),
		(#{documentNum},#{rowNum10},#{item10},#{itemName10},${amount10},#{unit10},${unitPrice10},${price10}),
		(#{documentNum},#{rowNum11},#{item11},#{itemName11},${amount11},#{unit11},${unitPrice11},${price11}),
		(#{documentNum},#{rowNum12},#{item12},#{itemName12},${amount12},#{unit12},${unitPrice12},${price12})
	</insert>
	
	
	<select id="getBillType" parameterType="int" resultType="systemDTO">
		select d2.documentTypeNum documentTypeNum, d2.documentTypeName from documentType d1 join documentType d2 on (d1.pair1=d2.documentTypeNum)  where d1.documentTypeNum = #{value}
	</select>
	<select id="getBillTypeName" parameterType="int" resultType="systemDTO">
		select * from documentType where documentTypeNum = #{value}
	</select>
	
	
	<update id="updateBillSheet1" parameterType="billSheet1DTO">
		update BillSheet1 set
			userNum = #{userNum},
			userName = #{userName},
			userDepartment = #{userDepartment},
			userPosition = #{userPosition},
			billDate = #{billDate},
			documentTypeNum = #{documentTypeNum},
			supplier = #{supplier},
			address = #{address},
			post = #{post},
			phoneNumber = #{phoneNumber},
			representative = #{representative},
			stamp = #{stamp},
			stampFileName = #{stampFileName},
			logoFileName = #{logoFileName},
			receiver = #{receiver},
			documentName = #{documentName},
			payCondition = #{payCondition},
			deadline = #{deadline},
			bankName = #{bankName},
			branchName = #{branchName},
			accountName = #{accountName},
			hurigana = #{hurigana},
			accountNumber = #{accountNumber},
			depositeClassification = #{depositeClassification},
			note = #{note},
			sum = #{sum},
			tax = #{tax},
			sumWithTax = #{sumWithTax},
			sumWithTax2 = #{sumWithTax2},	
			state = #{state},
			comment = #{comment},
			workflowNum = 
				<choose>
					<when test="workflowNum == 0">
						null,
					</when>
					<when test="workflowNum != 0">
						#{workflowNum},
					</when>
				</choose>
			updateDate = CURRENT_TIMESTAMP,
			updater = #{updater}
		where
			documentNum = #{documentNum}
	</update>
	<update id="updateBillSheet1Items" parameterType="billSheet1ItemsRecieveDTO">
		update BillSheet1Items set
			item = #{item1}, itemName = #{itemName1}, amount = ${amount1}, unit = #{unit1}, unitPrice = ${unitPrice1}, price = ${price1}
		where
			documentNum=#{documentNum} and rowNum = #{rowNum1};
			
		update BillSheet1Items set
			item = #{item2}, itemName = #{itemName2}, amount = ${amount2}, unit = #{unit2}, unitPrice = ${unitPrice2}, price = ${price2}
		where
			documentNum=#{documentNum} and rowNum = #{rowNum2};
			
		update BillSheet1Items set
			item = #{item3}, itemName = #{itemName3}, amount = ${amount3}, unit = #{unit3}, unitPrice = ${unitPrice3}, price = ${price3}
		where
			documentNum=#{documentNum} and rowNum = #{rowNum3};
			
		update BillSheet1Items set
			item = #{item4}, itemName = #{itemName4}, amount = ${amount4}, unit = #{unit4}, unitPrice = ${unitPrice4}, price = ${price4}
		where
			documentNum=#{documentNum} and rowNum = #{rowNum4};
			
		update BillSheet1Items set
			item = #{item5}, itemName = #{itemName5}, amount = ${amount5}, unit = #{unit5}, unitPrice = ${unitPrice5}, price = ${price5}
		where
			documentNum=#{documentNum} and rowNum = #{rowNum5};
			
		update BillSheet1Items set
			item = #{item6}, itemName = #{itemName6}, amount = ${amount6}, unit = #{unit6}, unitPrice = ${unitPrice6}, price = ${price6}
		where
			documentNum=#{documentNum} and rowNum = #{rowNum6};
			
		update BillSheet1Items set
			item = #{item7}, itemName = #{itemName7}, amount = ${amount7}, unit = #{unit7}, unitPrice = ${unitPrice7}, price = ${price7}
		where
			documentNum=#{documentNum} and rowNum = #{rowNum7};
			
		update BillSheet1Items set
			item = #{item8}, itemName = #{itemName8}, amount = ${amount8}, unit = #{unit8}, unitPrice = ${unitPrice8}, price = ${price8}
		where
			documentNum=#{documentNum} and rowNum = #{rowNum8};
			
		update BillSheet1Items set
			item = #{item9}, itemName = #{itemName9}, amount = ${amount9}, unit = #{unit9}, unitPrice = ${unitPrice9}, price = ${price9}
		where
			documentNum=#{documentNum} and rowNum = #{rowNum9};
			
		update BillSheet1Items set
			item = #{item10}, itemName = #{itemName10}, amount = ${amount10}, unit = #{unit10}, unitPrice = ${unitPrice10}, price = ${price10}
		where
			documentNum=#{documentNum} and rowNum = #{rowNum10};
			
		update BillSheet1Items set
			item = #{item11}, itemName = #{itemName11}, amount = ${amount11}, unit = #{unit11}, unitPrice = ${unitPrice11}, price = ${price11}
		where
			documentNum=#{documentNum} and rowNum = #{rowNum11};
		
		update BillSheet1Items set
			item = #{item12}, itemName = #{itemName12}, amount = ${amount12}, unit = #{unit12}, unitPrice = ${unitPrice12}, price = ${price12}
		where
			documentNum=#{documentNum} and rowNum = #{rowNum12}
	</update>
	<select id="getBillSheet1ByDocumentNum" parameterType="String" resultType="billSheet1DTO">
		select state, userNum from billSheet1 where documentNum = #{value}
	</select>
</mapper>